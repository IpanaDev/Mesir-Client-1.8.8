package ipana.modules.exploit;

import ipana.events.EventPostUpdate;
import ipana.events.EventPreUpdate;
import ipana.managements.module.Category;
import ipana.managements.module.Module;
import ipana.utils.player.PlayerUtils;
import net.minecraft.network.INetHandler;
import net.minecraft.network.Packet;
import org.lwjgl.input.Keyboard;

import pisi.unitedmeows.eventapi.event.listener.Listener;

import java.util.ArrayList;
import java.util.List;

public class Blink extends Module {
    public Blink() {
        super("Blink", Keyboard.KEY_NONE,Category.Exploit,"Teleports position to position");
    }

    private List<Packet<? extends INetHandler>> packets = new ArrayList<>();
    private int delay;
    private EventPreUpdate pre;

    private Listener<EventPreUpdate> onPre = new Listener<>(event -> {
        event.setCancelPackets(true);
        pre = event;
    });

    private Listener<EventPostUpdate> onPost = new Listener<>(event -> {
        delay--;
        if (delay <= 0) {
            packets.add(pre.getPacket());
            delay=1;
        }
    });
    @Override
    public void onDisable() {
        super.onDisable();
        for (Packet<? extends INetHandler> p : packets) {
            PlayerUtils.packet(p);
        }
        packets.clear();
        delay = 0;
    }
}
