package ipana.modules.exploit;

import ipana.managements.module.Category;
import ipana.managements.module.Module;
import ipana.managements.value.values.BoolValue;
import ipana.utils.player.PlayerUtils;
import net.minecraft.block.state.IBlockState;
import net.minecraft.init.Blocks;
import net.minecraft.network.play.client.C08PacketPlayerBlockPlacement;
import net.minecraft.util.BlockPos;
import net.minecraft.world.WorldServer;
import org.lwjgl.input.Keyboard;

import java.util.ArrayList;

public class WorldDumper extends Module {
    private ArrayList<PosState> posStates = new ArrayList<>();
    public BoolValue listen = new BoolValue("Listen", this, false,"Listen chunk packets.");

    public WorldDumper() {
        super("WorldDumper", Keyboard.KEY_NONE, Category.Exploit, "Copying a world");
    }

    @Override
    public void onEnable() {
        posStates.clear();
        super.onEnable();
    }


    @Override
    public void onDisable() {
        PlayerUtils.debug(posStates.size());
        for (PosState posState : this.posStates) {
            mc.theWorld.setBlockState(posState.pos, posState.blockState);
            for (WorldServer worldServer : mc.getIntegratedServer().worldServers) {
                worldServer.setBlockState(posState.pos, posState.blockState);
            }
        }
        this.posStates.clear();
        super.onDisable();
    }

    public void addPosState(BlockPos pos, IBlockState blockState) {
        if (blockState.getBlock() != Blocks.air) {
            //this.posStates.add(new PosState(pos, blockState));
        }
    }

    class PosState {
        BlockPos pos;
        IBlockState blockState;

        public PosState(BlockPos pos, IBlockState blockState) {
            this.pos = pos;
            this.blockState = blockState;
        }
    }
}
